[
  {
    "id": "eval-01-field-resolver",
    "name": "Simple Field Resolver",
    "skills": ["viaduct-field-resolver"],
    "query": "Create a Group entity with id, name, and description fields. Add a memberCount field that returns 42 for now. Use the viaduct skill for guidance.",
    "expected_behavior": [
      "Creates Group type with implements Node, @resolver, @scope",
      "Adds 'memberCount: Int! @resolver' to the Group type in schema",
      "Creates resolver class extending GroupResolvers.MemberCount()",
      "Uses @Resolver annotation",
      "Runs viaductCodegen to generate base classes"
    ],
    "verify_patterns": [
      "memberCount: Int!? @resolver",
      "GroupResolvers.MemberCount"
    ]
  },
  {
    "id": "eval-02-node-resolver",
    "name": "Node Type and Query Resolver",
    "skills": ["viaduct-node-type", "viaduct-query-resolver"],
    "query": "Create a Tag entity with id, name, and color fields. Add a query to fetch a single Tag by its ID. Implement the resolvers and return hardcoded data. Use the viaduct skill for guidance.",
    "expected_behavior": [
      "Creates Tag type with implements Node, @resolver, @scope",
      "Creates extend type Query with tag(id: ID! @idOf(type: \"Tag\")): Tag @resolver",
      "Creates TagNodeResolver extending NodeResolvers.Tag()",
      "Creates TagQueryResolver extending QueryResolvers.Tag()",
      "Uses ctx.arguments.id.internalID to get the UUID"
    ],
    "verify_patterns": [
      "NodeResolvers.Tag",
      "QueryResolvers.Tag",
      "internalID"
    ]
  },
  {
    "id": "eval-03-required-selection-set",
    "name": "Field Resolver with Required Selection Set",
    "skills": ["viaduct-field-resolver"],
    "query": "Create a GroupMember entity with id, userId, and role fields. Add a displayName field that shows 'User: ' followed by the userId. It needs to read the userId from the parent object. Use the viaduct skill for guidance.",
    "expected_behavior": [
      "Creates GroupMember type with implements Node, @resolver, @scope",
      "Adds 'displayName: String @resolver' to GroupMember type",
      "Creates resolver with @Resolver annotation specifying objectValueFragment",
      "Extends GroupMemberResolvers.DisplayName()",
      "Accesses userId via ctx.objectValue.getUserId()"
    ],
    "verify_patterns": [
      "displayName: String!? @resolver",
      "GroupMemberResolvers.DisplayName",
      "objectValueFragment|fragment .* on GroupMember",
      "getUserId"
    ]
  },
  {
    "id": "eval-04-batch-resolution",
    "name": "Batch Resolution for N+1 Prevention",
    "skills": ["viaduct-batch"],
    "query": "Create Tag (id, name) and Group (id, name) entities. Groups should have a tags field that returns a list of Tags. Make sure tags handles multiple groups efficiently without N+1 queries. Return hardcoded tags for now. Use the viaduct skill for guidance.",
    "expected_behavior": [
      "Creates Tag and Group types with implements Node, @resolver, @scope",
      "Adds tags: [Tag!]! @resolver to Group type",
      "Creates GroupTagsResolver extending GroupResolvers.Tags()",
      "Implements batchResolve with List<Context> parameter",
      "Returns List<FieldValue<List<Tag>>>",
      "Uses FieldValue.ofValue() for results"
    ],
    "verify_patterns": [
      "GroupResolvers.Tags",
      "batchResolve",
      "FieldValue"
    ]
  },
  {
    "id": "eval-05-mutations-globalid",
    "name": "Mutations with GlobalID Handling",
    "skills": ["viaduct-mutations"],
    "query": "Create a Tag entity with id, name, and color fields. Add mutations to create, update, and delete tags. Return mock data for now. Use the viaduct skill for guidance.",
    "expected_behavior": [
      "Creates Tag type with implements Node, @resolver, @scope",
      "Creates input types for create and update",
      "Creates extend type Mutation with createTag, updateTag, deleteTag",
      "Uses @idOf on ID fields in inputs and mutation args",
      "Uses input.id.internalID for update/delete",
      "Uses ctx.globalIDFor when building Tag response"
    ],
    "verify_patterns": [
      "MutationResolvers.CreateTag",
      "MutationResolvers.UpdateTag",
      "MutationResolvers.DeleteTag",
      "internalID",
      "globalIDFor"
    ]
  },
  {
    "id": "eval-06-scopes",
    "name": "Scope-based API Visibility",
    "skills": ["viaduct-scopes"],
    "query": "Create a Tag entity with id and name fields. Add admin-only operations for Tag: a way to get/set internalNotes, get usageCount, and delete all tags. These should only be visible to admin API consumers, not the default scope. Use the viaduct skill for guidance.",
    "expected_behavior": [
      "Creates Tag type with @scope(to: [\"default\"])",
      "Creates 'extend type Mutation @scope(to: [\"admin\"])' for admin mutations",
      "Uses mutations instead of fields (extend type Tag doesn't work)",
      "Includes deleteAllTags mutation"
    ],
    "verify_patterns": [
      "@scope\\(to: \\[\"admin\"\\]\\)",
      "extend type Mutation",
      "deleteAllTags",
      "MutationResolvers"
    ]
  },
  {
    "id": "eval-07-entity-relationships",
    "name": "Entity Relationships with Node References",
    "skills": ["viaduct-relationships"],
    "query": "Create User (id, name, email) and Tag (id, name, createdById) entities. Add a createdBy field on Tag that resolves to the User who created it. Also implement basic node resolvers for both types. Use the viaduct skill for guidance.",
    "expected_behavior": [
      "Creates User and Tag types with implements Node, @resolver, @scope",
      "Adds createdBy: User @resolver to Tag",
      "Creates TagCreatedByResolver with objectValueFragment including createdById",
      "Returns ctx.nodeFor(ctx.globalIDFor(User.Reflection, createdById))",
      "Does NOT fetch user data directly"
    ],
    "verify_patterns": [
      "TagResolvers.CreatedBy",
      "nodeFor",
      "globalIDFor.*User"
    ]
  },
  {
    "id": "gotcha-01-missing-idof-input",
    "name": "Gotcha: Input Type Missing @idOf",
    "skills": ["viaduct-mutations"],
    "query": "Implement the updateTask mutation. The resolver MUST extract the task ID from input.id and log it. Return mock data using that ID. Use the viaduct skill for guidance.",
    "expected_behavior": [
      "Recognizes @idOf is missing from UpdateTaskInput.id",
      "Adds @idOf(type: \"Task\") to the id field in schema",
      "Uses input.id.internalID in the resolver",
      "Does NOT manually decode Base64"
    ],
    "verify_patterns": [
      "@idOf\\(type: \"Task\"\\)",
      "MutationResolvers.UpdateTask",
      "internalID"
    ],
    "negative_patterns": [
      "Base64\\.getDecoder",
      "Base64\\.decode",
      "substringAfter\\(\":\"\\)"
    ]
  },
  {
    "id": "gotcha-02-missing-idof-query-arg",
    "name": "Gotcha: Query Argument Missing @idOf",
    "skills": ["viaduct-query-resolver"],
    "query": "I need to fetch a single project by ID. Implement the project query resolver. Return hardcoded data. Use the viaduct skill for guidance.",
    "expected_behavior": [
      "Recognizes @idOf is missing from query argument",
      "Adds @idOf(type: \"Project\") to the id argument",
      "Uses ctx.arguments.id.internalID in the resolver",
      "Does NOT manually decode Base64"
    ],
    "verify_patterns": [
      "project\\(id: ID! @idOf\\(type: \"Project\"\\)\\)",
      "QueryResolvers.Project",
      "internalID"
    ],
    "negative_patterns": [
      "Base64\\.getDecoder",
      "Base64\\.decode",
      "substringAfter\\(\":\"\\)"
    ]
  },
  {
    "id": "gotcha-03-globalid-response",
    "name": "Gotcha: Building GlobalID for Response",
    "skills": ["viaduct-mutations"],
    "query": "Implement the createItem mutation. Generate a UUID for the new item and return it with the input values. Use the viaduct skill for guidance.",
    "expected_behavior": [
      "Uses ctx.globalIDFor(Item.Reflection, uuid) to create GlobalID",
      "Does NOT pass raw UUID string to .id() method",
      "Uses Item.Builder pattern"
    ],
    "verify_patterns": [
      "MutationResolvers.CreateItem",
      "globalIDFor\\(.*Item\\.Reflection",
      "Item\\.Builder"
    ],
    "negative_patterns": [
      "\\.id\\([a-z]+Id\\)",
      "\\.id\\(uuid\\)",
      "\\.id\\(UUID\\."
    ]
  }
]
